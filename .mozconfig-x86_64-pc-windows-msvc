CROSS_BUILD=1
EXTRA_PATH="/mnt/MICROS~1/2019/Community/VC/Tools/MSVC/14.29.30133/bin/Hostx64/x64:"
TOOLTOOL_DIR=$HOME/tooltool12
FXC=${TOOLTOOL_DIR}/fxc2/bin/fxc2.exe
X=$(($(getconf _NPROCESSORS_ONLN 2>/dev/null || getconf NPROCESSORS_ONLN)))

export AR="${TOOLTOOL_DIR}/clang/bin/llvm-lib"
export CC="${TOOLTOOL_DIR}/clang/bin/clang-cl"
export CBINDGEN="${TOOLTOOL_DIR}/cbindgen/cbindgen"
export CXX="${TOOLTOOL_DIR}/clang/bin/clang-cl"
export DIA_SDK_PATH="/mnt/MICROS~1/2019/Community/DIASDK~1/"
export DISPLAY=:2
export HOST_CC="${TOOLTOOL_DIR}/clang/bin/clang"
export HOST_CXX="${TOOLTOOL_DIR}/clang/bin/clang++"
export LINKER="${TOOLTOOL_DIR}/clang/bin/lld-link"
export LLVM_DLLTOOL="${TOOLTOOL_DIR}/clang/bin/llvm-dlltool"
export MOZ_INCLUDE_SOURCE_INFO=1
export MOZ_LTO=cross
export WINDOWSSDKDIR="/mnt/WINDOW~1/10/"
export WIN32_REDIST_DIR="/mnt/MICROS~1/2019/Community/VC/Redist/MSVC/14.29.30133/x64/Microsoft.VC142.CRT/"
export WIN_UCRT_REDIST_DIR="${WINDOWSSDKDIR}/Redist/ucrt/DLLs/x64"
export MOZ_INCLUDE_SOURCE_INFO=1
export WINEDEBUG=-all

if test "$WFX_RELEASE"; then
    ac_add_options --enable-lto
    ac_add_options --enable-release
    ac_add_options --with-branding=browser/branding/waterfox
else
    ac_add_options --with-branding=browser/branding/dokimi
fi

mk_add_options "export LD_PRELOAD=${TOOLTOOL_DIR}/liblowercase/liblowercase.so"
mk_add_options "export LOWERCASE_DIRS=/mnt"
mk_add_options "export PATH=${TOOLTOOL_DIR}/wine/bin:{TOOLTOOL_DIR}/fxc2/bin:/mnt/LLVM/bin:${TOOLTOOL_DIR}/clang/bin:$EXTRA_PATH$PATH"
mk_add_options MOZ_MAKE_FLAGS=-j${X%.*}

ac_add_options --disable-bits-download
ac_add_options --disable-crashreporter
ac_add_options --disable-debug
ac_add_options --disable-default-browser-agent
ac_add_options --disable-dmd
ac_add_options --disable-geckodriver
ac_add_options --disable-maintenance-service
ac_add_options --disable-parental-controls
ac_add_options --disable-profiling
ac_add_options --disable-tests
ac_add_options --disable-verify-mar

ac_add_options --enable-ccache=${TOOLTOOL_DIR}/sccache/sccache
if test "$WFX_RELEASE"; then
    ac_add_options --enable-lto
fi
ac_add_options --enable-optimize="-O2 -Qvec -w -clang:-march=x86-64-v2 -clang:-mtune=haswell"
ac_add_options --enable-proxy-bypass-protection
ac_add_options --enable-rust-simd
ac_add_options --enable-updater

ac_add_options --target=x86_64-pc-mingw32

ac_add_options --with-app-basename=Waterfox
ac_add_options --with-app-name=waterfox
ac_add_options --with-distribution-id=net.waterfox
ac_add_options --with-l10n-base=$PWD/browser/locales/l10n
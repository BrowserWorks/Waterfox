. $topsrcdir/browser/config/mozconfig

export CC="icl"
export CXX="icl"
export LD="xilink"
export AR="xilib"

ac_add_options --enable-application=browser
mk_add_options MOZ_MAKE_FLAGS=-j4

mk_add_options MOZ_OBJDIR=objdir
mk_add_options MOZ_CO_MODULE="mozilla/tools/update-packaging"

# for 64-bit build
ac_add_options --target=x86_64-pc-mingw32
ac_add_options --host=x86_64-pc-mingw32

ac_add_options --with-app-name=waterfox
ac_add_options --with-branding=browser/branding/waterfox

# enable updater
ac_add_options --enable-update-channel=release
ac_add_options --enable-updater
ac_add_options --enable-update-packaging

# for 64-bit build
export MOZ_OPTIMIZE_LDFLAGS="-MACHINE:X64 -OPT:REF,ICF -FORCE"
mk_add_options MOZ_OPTIMIZE_LDFLAGS="-MACHINE:X64 -OPT:REF,ICF -FORCE"

# Use to use profiling
ac_add_options --enable-optimize="-Qstd=c++11 -D_ATL_XP_TARGETING -O3 -no-prec-div -Qparallel -arch:SSE3 -QaxCORE-AVX2,CORE-AVX-I,AVX,SSE4.2,SSE4.1,SSSE3 -w"

ac_add_options --disable-verify-mar
#ac_add_options --disable-jemalloc
ac_add_options --disable-crashreporter
ac_add_options --disable-maintenance-service
ac_add_options --disable-services-healthreport
ac_add_options --disable-telemetry-reporting
ac_add_options --disable-mochitest
ac_add_options --disable-mochitests
ac_add_options --disable-tests
ac_add_options --disable-ipdl-tests 

# for X64
WIN32_REDIST_DIR=$VCINSTALLDIR/redist/x64/Microsoft.VC120.CRT
